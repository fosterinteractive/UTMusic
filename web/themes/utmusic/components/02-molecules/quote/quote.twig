{% set variation = variation|default('') %}

{% if variation is not empty %}

  {# Add BEM variation '--' prefix if missing #}
  {% if variation starts with '--' %}
    {# Do nothing #}
  {% else %}
    {% set variation = '--' ~ variation %}
  {% endif %} 

{% endif %}

{% set icon = icon|default('quotes') %}
{% set text_size = text_size|default('normal') %}

{% if text %}
  <blockquote class="m-quote{{ variation }}">
    {% if image_main and variation == '--image' %}
      {# {% if carousel == 'true' %}
        <div class="m-quote{{ variation }}__images">
          {% if main_image_data %}
            <div class="m-quote{{ variation }}__image-main">
              <div class="m-image">
                <div class="m-image__image">
                  <img data-lazy="{{ file_url(main_image_data.path) }}" alt="{{ main_image_data.alt }}" width="{{ main_image_data.width }}" height="{{ main_image_data.height }}" />
                </div>
              </div>
            </div>
          {% endif %}

          {% if small_image_data %}
            <div class="m-quote{{ variation }}__image-small">
              <div class="m-image">
                <div class="m-image__image">
                  <img data-lazy="{{ file_url(small_image_data.path) }}" alt="{{ small_image_data.alt }}" width="{{ small_image_data.width }}" height="{{ small_image_data.height }}" />
                </div>
              </div>
            </div>
          {% endif %}
        </div>
      {% else %} #}
        <div class="m-quote{{ variation }}__images">
          <div class="m-quote{{ variation }}__image-main">
            {% include "@molecules/image/image.twig" with {
                image: image_main,
              } only
            %}
          </div>

          {% if image_small %}
            <div class="m-quote{{ variation }}__image-small">
              {% include "@molecules/image/image.twig" with {
                  image: image_small,
                } only
              %}
            </div>
          {% endif %}
        </div>
      {# {% endif %} #}
    {% endif %}  
    

    {% if text or source or additional_info %}
      <div class="m-quote{{ variation }}__content-wrapper">
        <div class="m-quote{{ variation }}__illustration">
          {% include "@atoms/icon/icon-sprite/icon-sprite.twig" with {
            directory: directory,
            base_class: 'a-icon',
            icon: icon,
            size: 'xsmall', 
            } only
          %}
          <div class="m-quote{{ variation }}__illustration-bg"></div>
        </div>

        {% if text %}
          <div class="m-quote__text m-quote{{ variation }}__text">
            {{ text }}
          </div>
        {% endif %}

        {% if source or additional_info %} 
          <cite class="m-quote{{ variation }}__source">
            {{" â€“ "}}{{ source }} 

            {% if additional_info %}
              <div class="m-quote__text-additional m-quote{{ variation }}__text-additional">
                {{ additional_info }}
              </div>
            {% endif %}
          </cite>
        {% endif %}

        

        {% if url and label %}
          {% include '@atoms/button/button.twig' with {
              directory: directory,
              base_class: 'a-button',
              label: label,
              variation: '',
              html_element: 'a',
              url: url,
              aria_label: aria_label,
              alignment: 'left',
              target: target,
            } only
          %} 
        {% endif %}
      </div>

    {% endif %}
      
  </blockquote>
{% endif %}

