{# Set default poster class - 'listing-item' #}
{% set variation = variation|default('') %}

{% if variation is not empty %}

  {# Add BEM variation '--' prefix if missing #}
  {% if variation starts with '--' %}
    {# Do nothing #}
  {% else %}
    {% set variation = '--' ~ variation %}
  {% endif %} 

{% endif %}

{% if sb_demo %}
  {% set directory = directory %}
{% else %}
  {% set directory =  'themes/utmusic' %}
{% endif %}

<div class="m-listing-item{{ variation }}{% if image %} has-img{% endif %}">
  
  <div class="m-listing-item{{ variation }}__content has-img">

    <div class="m-listing-item{{ variation }}__title">
      {% include "@atoms/text/headings/heading.twig" with {
          directory: directory,
          html_element: 'h3',
          appearance: 'h3',
          text: title,
          url: url,          
        } only
      %}
    </div>

    {% if date_string and variation != '--news-condensed' %}
      <div class="m-listing-item{{ variation }}__date">
        {{ date_string }}
      </div>
    {% endif %}

    {% if variation == '--news-condensed' %}
    <div class="m-listing-item{{variation}}__wrapper-tags-date">
    {% endif %}

      {% if news_categories or areas_study %}
        <div class="m-listing-item{{ variation }}__tags">

          {% for item in news_categories %}
            {% include '@atoms/chip/chip.twig' with {
                text: sb_demo ? item.category : item,
              } only 
            %}
          {% endfor %}

          {% for item in areas_study %}
            {% include '@atoms/chip/chip.twig' with {
                text: sb_demo ? item.area : item,
              } only 
            %}
          {% endfor %}

        </div>
        
      {% endif %}

      {% if date_string and variation == '--news-condensed' %}
        <div class="m-listing-item{{ variation }}__date">
          {{ date_string }}
        </div>
      {% endif %}

      {% if variation == '--news-condensed' %}
      </div>
      {% endif %}

        {# {% if text %}
      <div class="m-listing-item{{ variation }}__text" data-dotdotdot="elipsis">
        {% include "@molecules/text/text.twig" with {
            body: text,
          } only
        %}
      </div>
    {% endif %} #}

    {# {% if url %}
      <div class="m-listing-item{{ variation }}__button">
        {% set button_label = ('Read more'|t) %}

          {% include "@atoms/button/button.twig" with {
              label: button_label,
              html_element: 'a',
              variation: '',
              url: url,
              id: 'stories-listing-item-'|t ~ id,
              target: '',
              aria_label: title,
              alignment: 'left'
            } only
          %}
      </div>
    {% endif %} #}

  </div>

  {% if image %}
    <div class="m-listing-item{{ variation }}__img">
      {% include "@molecules/image/image.twig" with {
          image: image,
          variation: image_variation,
        } only
      %}
    </div>
  {% endif %}
</div>
